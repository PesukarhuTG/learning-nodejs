const getAge = (dateBirth) => {
  const today = new Date();
  const age = today.getFullYear() - dateBirth.getFullYear() - (today.getMonth() < dateBirth.getMonth() ||
        (today.getMonth() === dateBirth.getMonth() &&
        today.getDate() < dateBirth.getDate()));
  return age;
}

exports.getFullUserData = ({ name, dateBirth, purpose }) => {
  const separatedName = name.split(' ');
  const separatedPurpose = purpose.split(' ');
  const [ purposeFirstWord, ...rest ] = separatedPurpose;

  // get id
  const id = Math.random().toString().slice(3,13) + '';

  // get name data
  const firstName =
    separatedName[0].charAt(0).toUpperCase() + separatedName[0].substring(1);
  const lastName =
    separatedName[1].charAt(0).toUpperCase() + separatedName[1].substring(1);

  //get age data
  const separatedBirthDay = dateBirth.split('.').reverse();
  const formattedBirth = new Date(separatedBirthDay[0], separatedBirthDay[1], separatedBirthDay[2]);

  //get purpose data
  const editedPurpose = purposeFirstWord.charAt(0).toUpperCase() + purposeFirstWord.substring(1) + ' ' + rest.join(' ');

  return {
    id,
    firstName,
    lastName,
    dateBirth,
    age: getAge(formattedBirth),
    purpose: editedPurpose,
  };
};
